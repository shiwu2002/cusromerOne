# 实验室预约管理系统 - 微信小程序

## 项目概述

这是一个完整的实验室预约管理系统微信小程序，基于提供的API接口文档实现了所有功能模块。

## 技术栈

- 微信小程序原生开发
- ES6+ JavaScript
- WXML + WXSS
- RESTful API
- JWT认证

## 项目结构

```
wx/
├── api/                          # API封装层
│   ├── index.js                  # API统一导出
│   ├── user.js                   # 用户相关API（11个接口）
│   ├── email.js                  # 邮箱验证API（5个接口）
│   ├── laboratory.js             # 实验室API（7个接口）
│   ├── timeslot.js               # 时间段API（4个接口）
│   ├── reservation.js            # 预约API（13个接口）
│   ├── message.js                # 消息API（15个接口）
│   └── file.js                   # 文件上传API（4个接口）
├── utils/
│   ├── request.js                # 统一请求封装（含token管理）
│   └── util.js                   # 工具函数
├── pages/                        # 页面目录
│   ├── login/                    # 登录页面
│   ├── register/                 # 注册页面
│   ├── forgot-password/          # 忘记密码页面
│   ├── index/                    # 首页
│   ├── laboratory-list/          # 实验室列表页
│   ├── laboratory-detail/        # 实验室详情页
│   ├── reservation/              # 预约页面
│   ├── my-reservations/          # 我的预约列表页
│   ├── reservation-detail/       # 预约详情页
│   ├── messages/                 # 消息列表页
│   ├── message-detail/           # 消息详情页
│   ├── profile/                  # 个人中心页
│   └── settings/                 # 设置页面
├── app.js                        # 全局配置
├── app.json                      # 小程序配置
├── app.wxss                      # 全局样式
└── project.config.json           # 项目配置

每个页面包含4个文件：
- *.wxml  - 页面结构
- *.wxss  - 页面样式
- *.js    - 页面逻辑
- *.json  - 页面配置
```

## 功能模块

### 1. 用户认证模块
- ✅ 用户注册（邮箱验证）
- ✅ 用户登录（JWT认证）
- ✅ 忘记密码（邮箱重置）
- ✅ 自动登录状态检查
- ✅ Token自动刷新

### 2. 实验室管理模块
- ✅ 实验室列表展示（搜索、筛选、分页）
- ✅ 实验室详情查看
- ✅ 实验室图片轮播
- ✅ 实验室设备列表
- ✅ 时间段可用性查询
- ✅ 管理员实验室管理功能

### 3. 预约管理模块
- ✅ 创建预约（日期选择、时间段选择）
- ✅ 预约冲突检测
- ✅ 我的预约列表（状态筛选、搜索）
- ✅ 预约详情查看
- ✅ 取消预约
- ✅ 完成预约
- ✅ 预约历史记录
- ✅ 管理员预约审批

### 4. 消息系统模块
- ✅ 消息列表（分页加载）
- ✅ 消息详情查看
- ✅ 标记已读/未读
- ✅ 批量标记已读
- ✅ 删除消息
- ✅ 未读消息统计
- ✅ TabBar徽标显示
- ✅ 消息类型分类

### 5. 个人中心模块
- ✅ 个人信息展示
- ✅ 头像上传
- ✅ 编辑资料
- ✅ 修改密码
- ✅ 统计数据展示
- ✅ 快捷功能入口
- ✅ 管理员专属功能

### 6. 设置模块
- ✅ 通用设置（消息通知、声音、震动）
- ✅ 隐私设置
- ✅ 缓存管理
- ✅ 版本更新检查
- ✅ 关于我们
- ✅ 意见反馈
- ✅ 账号注销

## API接口覆盖率

### 已实现接口统计
- **用户相关**: 11/11 (100%)
- **邮箱验证**: 5/5 (100%)
- **实验室**: 7/7 (100%)
- **时间段**: 4/4 (100%)
- **预约**: 13/13 (100%)
- **消息**: 15/15 (100%)
- **文件上传**: 4/4 (100%)

**总计**: 59/59 接口 (100%)

## 核心功能特性

### 1. 认证与安全
- JWT Token认证机制
- Token自动续期
- 请求拦截器统一处理
- 登录状态自动检测
- 安全的密码重置流程

### 2. 用户体验
- 流畅的页面导航
- 下拉刷新数据
- 上拉加载更多
- 实时数据更新
- 友好的错误提示
- 加载状态提示
- 操作确认对话框

### 3. 数据管理
- 本地数据缓存
- 数据持久化
- 状态同步
- 实时统计更新
- 搜索与筛选

### 4. 界面设计
- 统一的视觉风格
- 紫色主题色调
- 卡片式布局
- 渐变背景设计
- 图标系统
- 响应式设计
- 动画效果

### 5. 文件处理
- 头像上传（图片）
- 实验室图片管理
- 文档上传
- 文件预览
- 多种格式支持

## TabBar导航

1. **首页** - 实验室浏览和快速预约
2. **我的预约** - 预约管理和历史记录
3. **消息** - 消息中心（带未读徽标）
4. **我的** - 个人中心和设置

## 使用说明

### 配置步骤

1. **修改API域名**
   ```javascript
   // app.js 第8行
   baseUrl: 'https://your-api-domain.com/api' 
   // 替换为实际的API域名
   ```

2. **配置小程序AppID**
   ```json
   // project.config.json
   {
     "appid": "your-appid-here"
   }
   ```

3. **上传代码**
   - 使用微信开发者工具打开项目
   - 点击"上传"按钮
   - 填写版本号和项目备注

### 开发调试

1. **安装微信开发者工具**
2. **导入项目**
3. **选择项目目录**: `/Volumes/data/cusromerOne/wx`
4. **开始调试**

### 用户角色

系统支持两种用户角色：

1. **普通用户(USER)**
   - 浏览实验室
   - 创建预约
   - 管理个人预约
   - 接收消息通知

2. **管理员(ADMIN)**
   - 所有普通用户功能
   - 管理实验室
   - 审批预约
   - 管理时间段
   - 发送系统消息

## 数据流转

```
用户操作 → 页面事件 → API调用 → 统一请求封装 
→ Token注入 → 发送请求 → 服务器处理 
→ 返回结果 → 错误处理 → 数据更新 → 界面刷新
```

## 状态管理

### 全局状态 (app.js)
- userInfo: 用户信息
- token: 认证令牌
- unreadCount: 未读消息数
- baseUrl: API基础地址

### 本地存储 (Storage)
- token: JWT令牌
- userInfo: 用户信息
- app_settings: 应用设置

## 错误处理

### 统一错误处理机制
- 401: 自动跳转登录页
- 403: 权限不足提示
- 404: 资源不存在提示
- 500: 服务器错误提示
- 网络错误: 网络异常提示

## 性能优化

1. **数据缓存**: 减少重复请求
2. **分页加载**: 降低单次数据量
3. **图片懒加载**: 优化加载速度
4. **防抖节流**: 优化频繁操作
5. **请求合并**: 减少请求次数

## 安全考虑

1. **Token管理**: 安全存储和传输
2. **数据加密**: 敏感信息加密
3. **输入验证**: 前端表单验证
4. **XSS防护**: 内容转义
5. **权限控制**: 角色权限检查

## 兼容性

- 微信版本要求: >= 7.0.0
- 基础库版本: >= 2.10.0
- 支持平台: iOS、Android

## 待扩展功能

虽然已实现所有接口功能，但以下功能可作为未来扩展：

1. 实验室收藏功能
2. 预约提醒推送
3. 实验报告上传
4. 用户评价系统
5. 数据统计分析
6. 二维码签到
7. 多语言支持

## 项目亮点

1. ✅ **完整的功能覆盖**: 100%实现所有API接口
2. ✅ **统一的代码规范**: 一致的命名和结构
3. ✅ **优雅的错误处理**: 完善的异常处理机制
4. ✅ **良好的用户体验**: 流畅的交互和及时的反馈
5. ✅ **清晰的代码注释**: 便于维护和扩展
6. ✅ **模块化设计**: API层、业务层分离
7. ✅ **响应式布局**: 适配不同屏幕尺寸

## 开发团队建议

### 后续维护
1. 定期更新依赖版本
2. 关注微信小程序API更新
3. 收集用户反馈优化体验
4. 监控错误日志
5. 性能监控和优化

### 部署建议
1. 配置正确的API域名
2. 设置合理的请求超时时间
3. 启用HTTPS加密传输
4. 配置服务器域名白名单
5. 定期备份用户数据

## 技术支持

如有问题，请参考：
1. 微信小程序官方文档
2. API接口文档 (MINI_PROGRAM_API.md)
3. 实体模型文档 (ENTITY_SCHEMA.md)
4. API使用说明 (API_USAGE.md)

## 版本信息

- **当前版本**: v1.0.0
- **完成日期**: 2026-01-14
- **开发状态**: ✅ 已完成

---

**注意**: 使用前请确保后端API服务已正常运行，并正确配置API域名。
