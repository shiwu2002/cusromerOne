<!--pages/laboratory-list/laboratory-list.wxml-->
<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input">
      <text class="search-icon">ğŸ”</text>
      <input type="text" placeholder="æœç´¢å®éªŒå®¤åç§°ã€ç¼–å·æˆ–ä½ç½®" value="{{keyword}}" bindinput="onSearchInput" confirm-type="search" bindconfirm="onSearch" />
      <text class="clear-icon" wx:if="{{keyword}}" bindtap="onClearSearch">âœ•</text>
    </view>
    <view class="filter-btn" bindtap="toggleFilter">
      <text>ç­›é€‰</text>
      <text class="filter-icon">{{showFilter ? 'â–²' : 'â–¼'}}</text>
    </view>
  </view>

  <!-- ç­›é€‰é¢æ¿ -->
  <view class="filter-panel" wx:if="{{showFilter}}">
    <view class="filter-group">
      <text class="filter-label">çŠ¶æ€ç­›é€‰ï¼š</text>
      <view class="filter-options">
        <view class="filter-option {{selectedStatus === null ? 'active' : ''}}" bindtap="selectStatus" data-status="{{null}}">
          å…¨éƒ¨
        </view>
        <view class="filter-option {{selectedStatus === 1 ? 'active' : ''}}" bindtap="selectStatus" data-status="{{1}}">
          å¯ç”¨
        </view>
        <view class="filter-option {{selectedStatus === 0 ? 'active' : ''}}" bindtap="selectStatus" data-status="{{0}}">
          ç»´æŠ¤ä¸­
        </view>
        <view class="filter-option {{selectedStatus === 2 ? 'active' : ''}}" bindtap="selectStatus" data-status="{{2}}">
          åœç”¨
        </view>
      </view>
    </view>

    <view class="filter-actions">
      <button class="btn-reset" bindtap="resetFilter">é‡ç½®</button>
      <button class="btn-confirm" bindtap="applyFilter">ç¡®å®š</button>
    </view>
  </view>

  <!-- å®éªŒå®¤åˆ—è¡¨ -->
  <view class="lab-list">
    <view class="lab-card" wx:for="{{laboratories}}" wx:key="id" bindtap="navigateToDetail" data-id="{{item.id}}">
      <image src="{{item.imageUrl}}" mode="aspectFill" class="lab-image" lazy-load></image>
      <view class="lab-info">
        <view class="lab-header">
          <text class="lab-name">{{item.labName}}</text>
          <view class="lab-status status-{{item.status}}">
            <text class="status-dot"></text>
            <text class="status-text">{{item.status === 1 ? 'å¯ç”¨' : item.status === 0 ? 'ç»´æŠ¤ä¸­' : 'åœç”¨'}}</text>
          </view>
        </view>
        
        <text class="lab-code">ç¼–å·ï¼š{{item.labNumber}}</text>
        <text class="lab-location">ğŸ“ {{item.location}}</text>
        
        <view class="lab-meta">
          <text class="lab-capacity">ğŸ‘¥ å®¹é‡: {{item.capacity}}äºº</text>
          <text class="lab-type">ğŸ”¬ {{item.labType}}</text>
        </view>
        
        <text class="lab-description">{{item.description}}</text>
        
        <view class="lab-footer">
          <text class="lab-equipment">è®¾å¤‡ï¼š{{item.equipment || 'æš‚æ— '}}</text>
          <text class="lab-arrow">â†’</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{laboratories.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ”¬</text>
    <text class="empty-text">{{keyword || selectedStatus !== null ? 'æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å®éªŒå®¤' : 'æš‚æ— å®éªŒå®¤æ•°æ®'}}</text>
    <button class="btn-refresh" bindtap="loadLaboratories">åˆ·æ–°</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{laboratories.length > 0 && hasMore && !loading}}">
    <text class="load-more-text" bindtap="loadMore">åŠ è½½æ›´å¤š</text>
  </view>

  <view class="no-more" wx:if="{{laboratories.length > 0 && !hasMore}}">
    <text class="no-more-text">æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>
