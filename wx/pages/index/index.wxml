<!--pages/index/index.wxml-->
<view class="container">
  <!-- è½®æ’­å›¾ -->
  <swiper class="banner-swiper" indicator-dots="{{true}}" autoplay="{{true}}" interval="{{3000}}" duration="{{500}}" circular="{{true}}">
    <swiper-item wx:for="{{banners}}" wx:key="index">
      <image src="{{item.image}}" mode="aspectFill" class="banner-image"></image>
    </swiper-item>
  </swiper>

  <!-- å¿«æ·å…¥å£ -->
  <view class="quick-menu">
    <view class="menu-item" bindtap="navigateToReservation">
      <view class="menu-icon">
        <text class="iconfont">ğŸ“…</text>
      </view>
      <text class="menu-text">æˆ‘è¦é¢„çº¦</text>
    </view>
    <view class="menu-item" bindtap="navigateToMyReservations">
      <view class="menu-icon">
        <text class="iconfont">ğŸ“‹</text>
      </view>
      <text class="menu-text">æˆ‘çš„é¢„çº¦</text>
    </view>
    <view class="menu-item" bindtap="navigateToMessages">
      <view class="menu-icon">
        <text class="iconfont">âœ‰ï¸</text>
        <view class="badge" wx:if="{{unreadCount > 0}}">{{unreadCount > 99 ? '99+' : unreadCount}}</view>
      </view>
      <text class="menu-text">æ¶ˆæ¯é€šçŸ¥</text>
    </view>
    <view class="menu-item" bindtap="navigateToProfile">
      <view class="menu-icon">
        <text class="iconfont">ğŸ‘¤</text>
      </view>
      <text class="menu-text">ä¸ªäººä¸­å¿ƒ</text>
    </view>
  </view>

  <!-- å…¬å‘Šæ  -->
  <view class="notice-bar" wx:if="{{notice}}">
    <text class="notice-icon">ğŸ“¢</text>
    <swiper class="notice-swiper" vertical="{{true}}" autoplay="{{true}}" interval="{{3000}}" duration="{{500}}" circular="{{true}}">
      <swiper-item>
        <text class="notice-text">{{notice}}</text>
      </swiper-item>
    </swiper>
  </view>

  <!-- æ¨èå®éªŒå®¤ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æ¨èå®éªŒå®¤</text>
      <text class="section-more" bindtap="navigateToLaboratoryList">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <view class="lab-list">
      <view class="lab-card" wx:for="{{laboratories}}" wx:key="id" bindtap="navigateToLaboratoryDetail" data-id="{{item.id}}">
        <image src="{{item.imageUrl || '/images/default-lab.png'}}" mode="aspectFill" class="lab-image"></image>
        <view class="lab-info">
          <view class="lab-header">
            <text class="lab-name">{{item.labName}}</text>
            <view class="lab-status" wx:if="{{item.status === 1}}">
              <text class="status-dot available"></text>
              <text class="status-text">å¯ç”¨</text>
            </view>
            <view class="lab-status" wx:else>
              <text class="status-dot unavailable"></text>
              <text class="status-text">{{item.status === 0 ? 'ç»´æŠ¤ä¸­' : 'åœç”¨'}}</text>
            </view>
          </view>
          <text class="lab-location">ğŸ“ {{item.location}}</text>
          <view class="lab-meta">
            <text class="lab-capacity">ğŸ‘¥ å®¹é‡: {{item.capacity}}äºº</text>
            <text class="lab-type">ğŸ”¬ {{item.labType}}</text>
          </view>
          <text class="lab-description">{{item.description}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{laboratories.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ”¬</text>
      <text class="empty-text">æš‚æ— æ¨èå®éªŒå®¤</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>

  <!-- ç”¨æˆ·ç»Ÿè®¡ -->
  <view class="section" wx:if="{{statistics}}">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„é¢„çº¦ç»Ÿè®¡</text>
    </view>
    <view class="statistics-grid">
      <view class="stat-item">
        <text class="stat-value">{{statistics.pending || 0}}</text>
        <text class="stat-label">å¾…å®¡æ ¸</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.approved || 0}}</text>
        <text class="stat-label">å·²é€šè¿‡</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.completed || 0}}</text>
        <text class="stat-label">å·²å®Œæˆ</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{statistics.cancelled || 0}}</text>
        <text class="stat-label">å·²å–æ¶ˆ</text>
      </view>
    </view>
  </view>
</view>
