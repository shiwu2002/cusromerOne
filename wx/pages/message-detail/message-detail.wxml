<!--pages/message-detail/message-detail.wxml-->
<view class="message-detail-container">
  <!-- æ¶ˆæ¯å¤´éƒ¨ -->
  <view class="message-header">
    <view class="type-badge type-{{messageDetail.type}}">
      <text class="type-icon">{{messageDetail.typeIcon}}</text>
      <text class="type-text">{{messageDetail.typeText}}</text>
    </view>
    <view class="time-info">{{messageDetail.formattedTime}}</view>
  </view>

  <!-- å‘é€è€…ä¿¡æ¯ -->
  <view class="sender-info" wx:if="{{messageDetail.senderName}}">
    <text class="sender-label">å‘ä»¶äººï¼š</text>
    <text class="sender-name">{{messageDetail.senderName}}</text>
  </view>

  <!-- æ¶ˆæ¯æ ‡é¢˜ -->
  <view class="message-title">{{messageDetail.title}}</view>

  <!-- æ¶ˆæ¯å†…å®¹ -->
  <view class="message-content">
    <text class="content-text">{{messageDetail.content}}</text>
  </view>

  <!-- é¢„çº¦ç›¸å…³ä¿¡æ¯ -->
  <view class="reservation-card" wx:if="{{messageDetail.reservationId}}">
    <view class="card-header">
      <text class="card-icon">ğŸ”—</text>
      <text class="card-title">ç›¸å…³é¢„çº¦</text>
    </view>
    <view class="reservation-info">
      <view class="info-row">
        <text class="label">é¢„çº¦ç¼–å·ï¼š</text>
        <text class="value">{{reservationDetail.reservationNumber || messageDetail.reservationId}}</text>
      </view>
      <view class="info-row" wx:if="{{reservationDetail.laboratory}}">
        <text class="label">å®éªŒå®¤ï¼š</text>
        <text class="value">{{reservationDetail.laboratory.name}}</text>
      </view>
      <view class="info-row" wx:if="{{reservationDetail.date}}">
        <text class="label">é¢„çº¦æ—¥æœŸï¼š</text>
        <text class="value">{{reservationDetail.date}}</text>
      </view>
      <view class="info-row" wx:if="{{reservationDetail.timeSlot}}">
        <text class="label">æ—¶é—´æ®µï¼š</text>
        <text class="value">{{reservationDetail.timeSlot.startTime}} - {{reservationDetail.timeSlot.endTime}}</text>
      </view>
      <view class="info-row" wx:if="{{reservationDetail.status}}">
        <text class="label">çŠ¶æ€ï¼š</text>
        <text class="value status-{{reservationDetail.status}}">{{reservationDetail.statusText}}</text>
      </view>
    </view>
    <view class="view-detail-btn" bindtap="goToReservation">
      <text>æŸ¥çœ‹è¯¦æƒ…</text>
      <text class="arrow">â†’</text>
    </view>
  </view>

  <!-- æ‹’ç»åŸå›  -->
  <view class="reject-card" wx:if="{{messageDetail.type === 'RESERVATION_REJECTED' && reservationDetail.rejectReason}}">
    <view class="card-header">
      <text class="card-icon">âŒ</text>
      <text class="card-title">æ‹’ç»åŸå› </text>
    </view>
    <view class="reject-reason">
      <text>{{reservationDetail.rejectReason}}</text>
    </view>
  </view>

  <!-- é™„åŠ ä¿¡æ¯ -->
  <view class="additional-info" wx:if="{{messageDetail.additionalInfo}}">
    <view class="info-title">é™„åŠ ä¿¡æ¯</view>
    <view class="info-content">
      <text>{{messageDetail.additionalInfo}}</text>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="action-buttons" wx:if="{{showActions}}">
    <button class="action-btn primary" bindtap="handlePrimaryAction">
      {{primaryActionText}}
    </button>
    <button class="action-btn secondary" wx:if="{{secondaryActionText}}" bindtap="handleSecondaryAction">
      {{secondaryActionText}}
    </button>
  </view>
</view>
